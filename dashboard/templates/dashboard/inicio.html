{% extends 'dashboard/base.html' %}
{% block title %}Inicio{% endblock %}
{% block header %}Gestión de Compras | Multifarma{% endblock %}

{% block content %}
<div class="inicio-layout">

  <div class="menu-column">
    <h3>Menú</h3>

    <div class="update-button-container">
      <button class="btn-update" onclick="actualizarArchivos()">🔄 Actualizar Archivos</button>
    </div>
  </div>

  <div class="calendar-column">
    <h3>Calendario de Actividades</h3>
    <iframe
      src="https://calendar.google.com/calendar/embed?src=analistadecomprasmultifarma%40gmail.com&ctz=America%2FBogota"
      style="border:0" width="100%" height="600" frameborder="0" scrolling="no">
    </iframe>
  </div>

</div>

<!-- Script para manejar la lógica del botón -->
<script>
function actualizarArchivos() {
  const boton = document.querySelector('.btn-update');
  boton.disabled = true;
  boton.innerText = "⏳ Actualizando...";

  fetch('/actualizar-archivos/')
    .then(res => res.json())
    .then(data => {
      alert(data.mensaje);
      boton.disabled = false;
      boton.innerText = "🔄 Actualizar Archivos";
    })
    .catch(err => {
      console.error(err);
      alert("Ocurrió un error al actualizar.");
      boton.disabled = false;
      boton.innerText = "🔄 Actualizar Archivos";
    });
}
</script>
{% endblock %}
